#!/usr/bin/env python
import argparse

# For debug
genR = "http://w3c.github.io/csvw/csv2rdf/?publishDate=2015-07-16;specStatus=CR"
genD = "http://localhost:8001/LocalData/github/csvw/publishing-snapshots/CR-csv2json/Overview.html"
#####

description = "Generate EPUB3 for a single W3C TR document, either in respec format (default) or generated from respec."


def process():
	"""
	Main entry point for command line usage.
	"""
	parser = argparse.ArgumentParser(description=description)
	parser.add_argument("URI", help="URI of the input; if this is in respec, it will passed on to the spec generator verbatim ")
	parser.add_argument("-r", "--respec",
						help="The source is not a respec file (but a final HTML), do not transform it",
						action='store_true')
	parser.add_argument("-d", "--debug",
						help="Debug with fixed document URI-s",
						action='store_true')
	args = parser.parse_args()

	from rp2epub import DocToEpub

	# TODO: Remove the Debug flag and branch!!!
	args.debug  = True
	args.respec = False

	# The debug branch does different things...
	if args.debug:
		uri = genR if args.respec else genD
	else :
		uri = args.URI

	DocToEpub(uri, args.respec).process()

if __name__ == '__main__':
	process()
